@using PoliteCaptcha
@model ReportMyPackageViewModel
@{
    ViewBag.Tab = "Packages";
    Layout = "~/Views/Shared/Gallery/Layout.cshtml";
}

<div class="container main-container page-report-abuse">
    <div class="row report-form">
        <div class="col-md-offset-1 col-md-10">
            <h1 class="page-heading text-center">Contact Support about <a href="@Url.Package(@Model.PackageId, Model.PackageVersion)">@Model.PackageId @Model.PackageVersion</a></h1>
            @using (Html.BeginForm())
            {
                @Html.AntiForgeryToken()
                @Html.SpamPreventionFields()

                <div id="form-field-reason" class="form-group @Html.HasErrorFor(m => m.Reason)">
                    @Html.ShowLabelFor(m => m.Reason)
                    <p>Please select the reason for contacting support about this package.</p>
                    @Html.ShowEnumDropDownListFor(m => m.Reason, Model.ReasonChoices, "<Choose a Reason>")
                    @Html.ShowValidationMessagesFor(m => m.Reason)
                </div>
                <div class="form-group @Html.HasErrorFor(m => m.Message)">
                    @Html.ShowLabelFor(m => m.Message)
                    <p>Please provide a detailed description of the problem.</p>
                    @Html.ShowTextAreaFor(m => m.Message, 10, 50)
                    @Html.ShowValidationMessagesFor(m => m.Message)
                </div>
                <div class="form-group @Html.HasErrorFor(m => m.CopySender)">
                    @Html.ShowCheckboxFor(m => m.CopySender)
                    @Html.ShowLabelFor(m => m.CopySender)
                    @Html.ShowValidationMessagesFor(m => m.CopySender)
                </div>
                <input type="submit" class="btn btn-primary form-control" value="Submit" title="Submit your problem with '@Model.PackageId'" />
            }
        </div>
    </div>
</div>

@section BottomScripts {
    @Html.SpamPreventionScript()
    <script type="text/javascript">
        function reasonSelected() {
            var $reason = $('#Reason');
            if ($reason.val()) {
                $reason.parents('form').validate().element($reason);
            }
        }

        $(function () {
            $('#Reason').change(reasonSelected);
            reasonSelected(); // Run once in case it starts with the bad selection
        });
    </script>
}