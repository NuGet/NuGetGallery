@model NuGetGallery.DisplayPackageViewModel

<thead>
    <tr>
        <th scope="col" role="columnheader">Version</th>
        <th scope="col" role="columnheader">Downloads</th>
        <th scope="col" role="columnheader">
            Last Updated
            @if (Model.CanDisplayPrivateMetadata)
            {
                <a class="tooltip-target" href="javascript:void(0)" role="button" aria-labelledby="lastupdatedid">
                    <i class="ms-Icon ms-Icon--Info info-icon"></i>
                    <span class="tooltip-block" role="tooltip" id="lastupdatedid">
                        <span class="tooltip-wrapper tooltip-with-icon popover right">
                            <span class="arrow"></span>
                            <span class="popover-content">
                                The individual who pushed the latest update, or the organization if pushed by a co-owner who isn't a member. This information is not publicly visible.
                            </span>
                        </span>
                    </span>
                </a>
            }
        </th>

        @if (Model.CanDisplayPrivateMetadata)
        {
            <th scope="col" role="columnheader">Status</th>
        }
        @if (Model.IsCertificatesUIEnabled)
        {
            <th scope="col" role="columnheader" aria-hidden="true" abbr="Signature Information"></th>
        }
        @if (Model.IsPackageDeprecationEnabled || Model.IsPackageVulnerabilitiesEnabled)
        {
            <th scope="col" role="columnheader" aria-hidden="true" abbr="Package Warnings"></th>
        }
    </tr>
</thead>
<tbody class="no-border">
    @foreach (var packageVersion in Model.PackageVersions)
    {
        if ((packageVersion.Available && packageVersion.Listed && Model.ShowDetailsAndLinks)
            || (!packageVersion.Deleted && Model.CanDisplayPrivateMetadata))
        {
            <tr class="@(packageVersion.IsCurrent(Model) ? "bg-brand-info" : null) version-row"
                data-prerelease="@packageVersion.Prerelease.ToString().ToLowerInvariant()"
                data-vulnerable="@packageVersion.IsVulnerable.ToString().ToLowerInvariant()"
                data-deprecated="@((packageVersion.DeprecationStatus != PackageDeprecationStatus.NotDeprecated).ToString().ToLowerInvariant())">
                <td>
                    <a href="@Url.Package(packageVersion)" title="@packageVersion.Version">
                        @packageVersion.Version.Abbreviate(30)
                    </a>
                </td>
                <td>
                    @packageVersion.DownloadCount.ToNuGetNumberString()
                </td>
                <td>
                    <span data-datetime="@packageVersion.LastUpdated.ToString("O")">@packageVersion.LastUpdated.ToNuGetShortDateString()</span>
                    @if (packageVersion.PushedBy != null)
                    {
                        <text>
                            by <span title="@packageVersion.PushedBy">@packageVersion.PushedBy.Abbreviate(15)</span>
                        </text>
                    }
                </td>
                @if (packageVersion.CanDisplayPrivateMetadata)
                {
                    var packageStatusSummary = packageVersion.PackageStatusSummary;

                    <td>
                        @if (packageStatusSummary == PackageStatusSummary.Listed ||
                                packageStatusSummary == PackageStatusSummary.Unlisted)
                        {
                            <a href="@Url.ManagePackage(packageVersion)">@NuGetGallery.Helpers.EnumHelper.GetDescription(packageStatusSummary)</a>
                        }
                        else
                        {
                            @NuGetGallery.Helpers.EnumHelper.GetDescription(packageStatusSummary)
                        }
                    </td>
                }

                @if (Model.IsCertificatesUIEnabled)
                {
                    if (string.IsNullOrEmpty(packageVersion.SignatureInformation))
                    {
                        <td class="package-icon-cell" aria-hidden="true"></td>
                    }
                    else
                    {
                        <td class="package-icon-cell">
                            <i class="ms-Icon ms-Icon--Ribbon package-icon" title="@packageVersion.SignatureInformation"></i>
                        </td>
                    }
                }

                @if (string.IsNullOrEmpty(packageVersion.PackageWarningIconTitle))
                {
                    <td class="package-icon-cell" aria-hidden="true"></td>
                }
                else
                {
                    <td class="package-icon-cell package-warning-icon">
                        <a class="tooltip-target tooltip-icon--black-icon" href="javascript:void(0)" role="button" aria-describedby="package-icon-@packageVersion.Version">
                            <i class="ms-Icon ms-Icon--Warning package-icon"></i>
                            <span class="tooltip-block" role="tooltip" id="package-icon-@packageVersion.Version">
                                <span class="tooltip-wrapper tooltip-with-icon popover right">
                                    <span class="arrow"></span>
                                    <span class="popover-content">
                                        @packageVersion.PackageWarningIconTitle
                                    </span>
                                </span>
                            </span>
                        </a>
                    </td>
                }
            </tr>
        }
        else if (packageVersion.Deleted && packageVersion.CanDisplayPrivateMetadata)
        {
            <tr class="deleted version-row"
                data-prerelease="@packageVersion.Prerelease.ToString().ToLowerInvariant()"
                data-vulnerable="@packageVersion.IsVulnerable.ToString().ToLowerInvariant()"
                data-deprecated="@((packageVersion.DeprecationStatus != PackageDeprecationStatus.NotDeprecated).ToString().ToLowerInvariant())">
                <td class="version">
                    @packageVersion.Version
                </td>
                <td>
                    @packageVersion.DownloadCount
                </td>
                <td>
                    <span data-datetime="@packageVersion.LastUpdated.ToString("O")">@packageVersion.LastUpdated.ToNuGetShortDateString()</span>
                </td>
                <td>
                    Deleted
                </td>
                <td colspan="2"></td>
            </tr>
        }
    }
</tbody>
